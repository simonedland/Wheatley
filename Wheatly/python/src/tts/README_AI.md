# AI Summary

### C:\GIT\Wheatly\Wheatley\Wheatly\python\src\tts\tts_engine.py
### Overview

The script is a Python-based Text-to-Speech (TTS) application that uses the ElevenLabs API to convert text into speech and play the resulting audio. It is designed to read configuration settings from a YAML file, generate audio using specified voice parameters, and play the audio while managing temporary files.

### Main Components

1. **External Dependencies:**
   - `playsound`: Used to play audio files.
   - `elevenlabs.client` and `elevenlabs.VoiceSettings`: Used to interact with the ElevenLabs TTS API.
   - `yaml`: Used to read configuration settings from a YAML file.
   - `datetime`: Used to generate timestamps for unique file naming.
   - `logging`: Configured to manage logging levels for the ElevenLabs library.

2. **Classes and Functions:**

   - **`TextToSpeechEngine` Class:**
     - **`__init__` Method:**
       - Loads configuration from a YAML file located in a `config` directory.
       - Initializes ElevenLabs API client with an API key and voice settings.
       - Configures logging to suppress verbose output from the ElevenLabs library.

     - **`elevenlabs_generate_audio` Method:**
       - Uses the ElevenLabs API to convert text into audio using the configured voice settings.
       - Returns audio chunks generated by the API.

     - **`generate_and_play_advanced` Method:**
       - Manages the creation of a temporary directory for storing audio files.
       - Calls `elevenlabs_generate_audio` to generate audio from text.
       - Saves the audio to a uniquely named file using a timestamp.
       - Plays the audio using `playsound`.
       - Deletes the temporary audio file after playback.

3. **Execution Flow:**
   - The script is designed to be run as a standalone application.
   - When executed, it creates an instance of `TextToSpeechEngine`.
   - Calls `generate_and_play_advanced` with a sample text to demonstrate functionality.

### Configuration and Structure

- **Configuration File:**
  - Located at `config/config.yaml`, it contains settings for TTS such as `voice_id`, `stability`, `similarity_boost`, `style`, `use_speaker_boost`, `speed`, `model_id`, and `output_format`.
  - Also includes a `secrets` section for storing the ElevenLabs API key.

- **Directory Structure:**
  - The script expects a `temp` directory at the project root for storing temporary audio files.
  - Ensures the directory exists or creates it as needed.

### Notable Logic

- **Audio Generation and Playback:**
  - The script generates audio in chunks, writes them to a temporary file, and plays the file using `playsound`.
  - Implements error handling for both playback and file deletion to ensure smooth operation and cleanup.

- **Timestamped File Naming:**
  - Uses the current date and time to create unique filenames for each audio file, preventing conflicts and ensuring traceability.

### Summary

This script provides a robust solution for converting text to speech using ElevenLabs, with configurable voice settings and efficient management of temporary audio files. It is designed to be easily configurable and extendable, with clear separation of concerns between configuration, audio generation, and playback.
